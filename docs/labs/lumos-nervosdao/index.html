<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-labs/lumos-nervosdao">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CPNK56S8G3"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-CPNK56S8G3",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Nervos CKB" href="/opensearch.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&display=swap">
<script src="/js/extra.js"></script><title data-rh="true">Introduction to Lumos via NervosDAO | Nervos CKB</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.nervos.org/img/undraw_online.svg"><meta data-rh="true" name="twitter:image" content="https://docs.nervos.org/img/undraw_online.svg"><meta data-rh="true" property="og:url" content="https://docs.nervos.org/docs/labs/lumos-nervosdao"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Introduction to Lumos via NervosDAO | Nervos CKB"><meta data-rh="true" name="description" content="In the real world, one hardly sees a blockchain exposed and used directly by the ordinary users. Apps, websites or other services are built on top of blockchains to provide a seamless service. Based on this belief, we built lumos, a JavaScript/TypeScript framework, that aids dapp development on CKB. Lumos should be able to free you from most, if not all of the hassles for dealing with CKB, and let you focus on the specific logic in your dapp."><meta data-rh="true" property="og:description" content="In the real world, one hardly sees a blockchain exposed and used directly by the ordinary users. Apps, websites or other services are built on top of blockchains to provide a seamless service. Based on this belief, we built lumos, a JavaScript/TypeScript framework, that aids dapp development on CKB. Lumos should be able to free you from most, if not all of the hassles for dealing with CKB, and let you focus on the specific logic in your dapp."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.nervos.org/docs/labs/lumos-nervosdao"><link data-rh="true" rel="alternate" href="https://docs.nervos.org/docs/labs/lumos-nervosdao" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.nervos.org/docs/labs/lumos-nervosdao" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://LU9B8PQ7W5-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.88793b4f.css">
<link rel="preload" href="/assets/js/runtime~main.b62abc76.js" as="script">
<link rel="preload" href="/assets/js/main.8e1dff1b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Nervos CKB" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Nervos CKB" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a class="navbar__item navbar__link" href="/docs/basics/introduction">Basics</a><a class="navbar__item navbar__link" href="/docs/reference/introduction">Reference</a><a class="navbar__item navbar__link" href="/docs/labs/introduction">Labs</a><a class="navbar__item navbar__link" href="/docs/integrate/introduction">Integrate</a><a class="navbar__item navbar__link" href="/docs/essays/introduction">Essays</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/basics/concepts/cell-model">basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/essays/ckb-core-dev">essays</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/integrate/introduction">integrate</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/labs/capsule-dynamic-loading-tutorial">labs</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/labs/capsule-dynamic-loading-tutorial">Dynamic loading in Capsule</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/labs/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/labs/lumos-nervosdao">Introduction to Lumos via NervosDAO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/labs/sudtbycapsule">Write an SUDT Script by Capsule</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/reference/cell">reference</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">labs</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Introduction to Lumos via NervosDAO</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Introduction to Lumos via NervosDAO</h1></header><p>In the real world, one hardly sees a blockchain exposed and used directly by the ordinary users. Apps, websites or other services are built on top of blockchains to provide a seamless service. Based on this belief, we built <a href="https://github.com/nervosnetwork/lumos" target="_blank" rel="noopener noreferrer">lumos</a>, a JavaScript/TypeScript framework, that aids dapp development on CKB. Lumos should be able to free you from most, if not all of the hassles for dealing with CKB, and let you focus on the specific logic in your dapp.</p><p>In this tutorial, we will provide an introduction on lumos via a real example: <a href="https://github.com/nervosnetwork/rfcs/blob/master/rfcs/0023-dao-deposit-withdraw/0023-dao-deposit-withdraw.md" target="_blank" rel="noopener noreferrer">Nervos DAO</a>, while quite valuable on CKB, can be a real pain to integrate for many dapps. Here we will demonstrate that how lumos can be used to streamline Nervos DAO integration.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="components">Components<a class="hash-link" href="#components" title="Direct link to heading">​</a></h2><p>Lumos is designed as a framework, meaning it is expected to be used in a intrinsic way: certain setup code will be needed when you first boot your application. Global states might also be kept in your application memory space for bookkeeping purposes. That being said, lumos is also organized into several components, some of which might be used in a non-intrinsic stateless fashion. In general, lumos consists of the following components:</p><ul><li><a href="https://github.com/nervosnetwork/lumos/tree/v0.4.0/packages/indexer" target="_blank" rel="noopener noreferrer">indexer</a>: a CKB cell indexer that fulfills <a href="/docs/reference/cell#index-query-assemble-pattern">Index-Query-Assemble</a> pattern. For now, this package only contains RocksDB backed indexer. A <a href="https://github.com/nervosnetwork/lumos/tree/v0.4.0/packages/sql-indexer" target="_blank" rel="noopener noreferrer">separate pacakge</a> contains SQL backed indexer using the same interface. Later, we might merge the 2 packages into one for consistency.</li><li><a href="https://github.com/nervosnetwork/lumos/tree/v0.4.0/packages/base" target="_blank" rel="noopener noreferrer">base</a>: a base package containing common types and utilities that are used by most packages. If there is a CKB specific task you need to perform, you might want to look here first. Chances are they are already provided.</li><li><a href="https://github.com/nervosnetwork/lumos/tree/v0.4.0/packages/helpers" target="_blank" rel="noopener noreferrer">helpers</a>: a helper package containing more utilities. The difference between <code>helpers</code> and <code>base</code>, is that <code>base</code> contains pure stateless functions, while <code>helpers</code> works in a more intrinsic way: it requires <code>config-manager</code> mentioned below to be setup.</li><li><a href="https://github.com/nervosnetwork/lumos/tree/v0.4.0/packages/common-scripts" target="_blank" rel="noopener noreferrer">common-scripts</a>: integrations for known scripts on CKB. While we try our best to provide integrations for popular CKB scripts, people might be working on innovations everyday. As a result, we are also designing a set of APIs, so developers can freely integrate their own scripts into lumos for everyone to use. One integrated, <code>common-scripts</code> should be able to leverage those new scripts as well.</li><li><a href="https://github.com/nervosnetwork/lumos/tree/v0.4.0/packages/config-manager" target="_blank" rel="noopener noreferrer">config-manager</a>: a manager for dealing with differences between different chains, such as mainnet, testnet, or numerous dev chains. We abstract each chain into individual config file. Once loaded, config manager will be able to handle the chain specific logic, so you don&#x27;t have to deal with this in your own code.</li><li><a href="https://github.com/nervosnetwork/lumos/tree/v0.4.0/packages/transaction-manager" target="_blank" rel="noopener noreferrer">transaction-manager</a>: a transaction manager for CKB. One problem with UTXO based blockchains, is that a certain amount of gap period exists between a transaction is accepted by a blockchain, and when it is actually committed on chain. During this gap, new cells created by the pending transaction will not be available. Transaction manager package takes care of this. It wraps an indexer instance, and makes sure cells created in pending transactions, are also exposed and available for assembling new transactions. This means you are no longer bounded to one transaction at a time, you can freely send series of transactions as you wish.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="initial-ckb-setup">Initial CKB Setup<a class="hash-link" href="#initial-ckb-setup" title="Direct link to heading">​</a></h2><p>To ease the whole process so we don&#x27;t have to wait too long to see the results, let&#x27;s setup our own dev chain with <a href="/docs/basics/guides/devchain#4-adjust-the-parameters-to-shorten-the-block-interval-optional">tweaks</a>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">TOP</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable builtin class-name" style="color:rgb(255, 203, 107)">pwd</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># I&#x27;m testing this on a Linux machine, if you use other platforms, please adjust</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># this accordingly.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -LO https://github.com/nervosnetwork/ckb/releases/download/v0.33.0/ckb_v0.33.0_x86_64-unknown-linux-gnu.tar.gz</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">tar</span><span class="token plain"> xzf ckb_v0.33.0_x86_64-unknown-linux-gnu.tar.gz</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable environment constant" style="color:rgb(130, 170, 255)">PATH</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PATH</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token variable" style="color:rgb(191, 199, 213)">$TOP</span><span class="token plain">/ckb_v0.33.0_x86_64-unknown-linux-gnu</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ ckb -V</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ckb </span><span class="token number" style="color:rgb(247, 140, 108)">0.33</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ ckb init -C devnet -c dev</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ ed devnet/specs/dev.toml </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">91d</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">90a</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">genesis_epoch_length = 10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">permanent_difficulty_in_dummy = true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">wq</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ ed devnet/ckb-miner.toml </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">39s/5000/1000/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">wq</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ ed devnet/ckb.toml </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">143a</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">[block_assembler]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">code_hash = &quot;0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)"># private key: 0x29159d8bb4b27704b168fc7fae70ffebf82164ce432b3f6b4c904a116a969f19</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">args = &quot;0xcbfbb9edb5838e2d61061c3fc69eaaa5fdbd3273&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">hash_type = &quot;type&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">message = &quot;0x&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">wq</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ ckb run -C devnet</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here we are making the following configuration:</p><ul><li>Create a dev chain</li><li>Modify the chain config to skip difficulty adjustment, and set all epoch to contain 10 blocks</li><li>Modify miner config to generate a new block every second</li><li>Use a specific private key as the wallet used in miner. Please do not use this private key elsewhere!</li><li>Start a CKB node with the dev chain</li></ul><p>In a different terminal, we can also start the CKB miner:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">TOP</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable builtin class-name" style="color:rgb(255, 203, 107)">pwd</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable environment constant" style="color:rgb(130, 170, 255)">PATH</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PATH</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token variable" style="color:rgb(191, 199, 213)">$TOP</span><span class="token plain">/ckb_v0.33.0_x86_64-unknown-linux-gnu</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ ckb miner -C devnet</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="node-skeleton">Node Skeleton<a class="hash-link" href="#node-skeleton" title="Direct link to heading">​</a></h2><p>Now with CKB ready, we can create the node skeleton used to run our JS code:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> nervosdao-skeleton</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> nervosdao-skeleton</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">yarn</span><span class="token plain"> init</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">yarn</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> @ckb-lumos/indexer@0.4.3 @ckb-lumos/common-scripts@0.4.3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In this lab, we will run the operation needed from a node shell with async/await enabled:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">node</span><span class="token plain"> --experimental-repl-await</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Welcome to Node.js v12.16.2.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Type </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;.help&quot;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">more</span><span class="token plain"> information.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But this is only for demonstration purposes. There&#x27;s nothing stopping you from copying the same code into a file that is then executed by node.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="config-manager-setup">Config Manager Setup<a class="hash-link" href="#config-manager-setup" title="Direct link to heading">​</a></h2><p>The first step in using lumos, is setting up config manager. Even though CKB has a unified programming model, different configurations would still be required for different chain instances, such as mainnet, testnet or dev chains. Config manager allows the node app to boot with a specific chain configuration, so other parts in lumos can consult config manager directly for information.</p><p>If you are using a well known chain configuration, you can use <code>LUMOS_CONFIG_NAME</code> environment variable to setup config manager:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ LUMOS_CONFIG_NAME=LINA node --experimental-repl-await</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Welcome to Node.js v12.16.2.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Type &quot;.help&quot; for more information.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const { initializeConfig, getConfig } = require(&quot;@ckb-lumos/config-manager&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; initializeConfig();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; getConfig();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  PREFIX: &#x27;ckb&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  SCRIPTS: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SECP256K1_BLAKE160: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      CODE_HASH: &#x27;0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      HASH_TYPE: &#x27;type&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      TX_HASH: &#x27;0x71a7ba8fc96349fea0ed3a5c47992e3b4084b031a42264a018e0072e8172e46c&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      INDEX: &#x27;0x0&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      DEP_TYPE: &#x27;dep_group&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      SHORT_ID: 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SECP256K1_BLAKE160_MULTISIG: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      CODE_HASH: &#x27;0x5c5069eb0857efc65e1bca0c07df34c31663b3622fd3876c876320fc9634e2a8&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      HASH_TYPE: &#x27;type&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      TX_HASH: &#x27;0x71a7ba8fc96349fea0ed3a5c47992e3b4084b031a42264a018e0072e8172e46c&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      INDEX: &#x27;0x1&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      DEP_TYPE: &#x27;dep_group&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      SHORT_ID: 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    DAO: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      CODE_HASH: &#x27;0x82d76d1b75fe2fd9a27dfbaa65a039221a380d76c926f378d3f81cf3e7e13f2e&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      HASH_TYPE: &#x27;type&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      TX_HASH: &#x27;0xe2fb199810d49a4d8beec56718ba2593b665db9d52299a0f9e6e75416d73ff5c&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      INDEX: &#x27;0x2&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      DEP_TYPE: &#x27;code&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Supported well known configurations include:</p><ul><li><code>LINA</code>: mainnet config;</li><li><code>AGGRON4</code>: current testnet config. Note at certain time, we might reset testnet, in that case, lumos might be upgraded with new testnet configurations.</li></ul><p>However there might be cases, where you don&#x27;t use a pre-defined configuration. For example, the dev chain we use here, does not have a pre-defined configuration. Lumos also supports setting up config manager via a local config file. You can use <code>LUMOS_CONFIG_FILE</code> environment variable to point to the config file. If neither config variable is set, lumos will try to read config file from <code>config.json</code> file in current directory.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ cat &lt;&lt;EOF &gt; config.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;PREFIX&quot;: &quot;ckt&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;SCRIPTS&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;SECP256K1_BLAKE160&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;CODE_HASH&quot;: &quot;0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;HASH_TYPE&quot;: &quot;type&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;TX_HASH&quot;: &quot;0xace5ea83c478bb866edf122ff862085789158f5cbff155b7bb5f13058555b708&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;INDEX&quot;: &quot;0x0&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;DEP_TYPE&quot;: &quot;dep_group&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;SHORT_ID&quot;: 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;SECP256K1_BLAKE160_MULTISIG&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;CODE_HASH&quot;: &quot;0x5c5069eb0857efc65e1bca0c07df34c31663b3622fd3876c876320fc9634e2a8&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;HASH_TYPE&quot;: &quot;type&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;TX_HASH&quot;: &quot;0xace5ea83c478bb866edf122ff862085789158f5cbff155b7bb5f13058555b708&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;INDEX&quot;: &quot;0x1&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;DEP_TYPE&quot;: &quot;dep_group&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;SHORT_ID&quot;: 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;DAO&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;CODE_HASH&quot;: &quot;0x82d76d1b75fe2fd9a27dfbaa65a039221a380d76c926f378d3f81cf3e7e13f2e&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;HASH_TYPE&quot;: &quot;type&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;TX_HASH&quot;: &quot;0xa563884b3686078ec7e7677a5f86449b15cf2693f3c1241766c6996f206cc541&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;INDEX&quot;: &quot;0x2&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;DEP_TYPE&quot;: &quot;code&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ LUMOS_CONFIG_FILE=&quot;config.json&quot; node --experimental-repl-await</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Welcome to Node.js v12.16.2.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Type &quot;.help&quot; for more information.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const { initializeConfig, getConfig } = require(&quot;@ckb-lumos/config-manager&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; initializeConfig();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now config manager is successfully setup, we can proceed to the next step.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="booting-indexer">Booting Indexer<a class="hash-link" href="#booting-indexer" title="Direct link to heading">​</a></h2><p>Lumos is designed based on the <a href="/docs/reference/cell#index-query-assemble-pattern">Index-Query-Assemble</a> pattern, meaning a dapp shall hava an indexer that keeps indexing new blocks in a format that is easier to query. This means any dapp built with lumos, should also have an indexer configured and running at all time:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const { Indexer } = require(&quot;@ckb-lumos/indexer&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const indexer = new Indexer(&quot;http://127.0.0.1:8114&quot;, &quot;./indexed-data&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; indexer.startForever();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here we are using the RocksDB backed indexer for simplicity. Lumos provides 2 indexer types:</p><ul><li>RocksDB backed indexer</li><li>SQL backed indexer, supported SQL databases now include MySQL and PostgreSQL.</li></ul><p>If you want to test against the SQL indexer, some modifications to the above setup code might be required.</p><p>You can check current indexed tip with the following code snippet:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; await indexer.tip()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  block_number: &quot;0x29c&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  block_hash: &quot;0x3e44b571c82a09117231baee1939d38440d71f56de8bc600ac32b1dead9be46d&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Please wait a while till lumos has caught up with the current chain tip. This should not take much time for a dev chain.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deposit">Deposit<a class="hash-link" href="#deposit" title="Direct link to heading">​</a></h2><p>To deposit to Nervos DAO, we need to first create a deposit transaction. You could of course go the hard way and create a transaction manually, but lumos has already provide a solution for simplifying transaction creation. Let&#x27;s look at <code>TransactionSkeleton</code> and how it works in lumos first.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="transaction-skeleton">Transaction Skeleton<a class="hash-link" href="#transaction-skeleton" title="Direct link to heading">​</a></h3><p>CKB provides great flexibility for dapp developers to build anything they want. But we all know that <strong>with great power comes great responsibility</strong>, a flexible programming model also significantly complicates transaction assembling. This includes but might not be limited to the following hurdles:</p><ul><li>Different scripts used in transaction inputs will require separate message generation, and also separate signing steps.</li><li>Some cells might require special argument setup in witness, due to type script validation rules.</li><li>Coordination might be required, since both lock script and type script in a cell might require arguments in the same witness construct.</li></ul><p>Those problems will haunt you even when you are dealing with a single NervosDAO transaction. It is only gonna get more complicated, when we consider multiple cells containing different CKB scripts composed together. Looking into the future, we will definitely need a solution to this issue.</p><p><code>TransactionSkeleton</code> is the answer we propose in lumos. Each transaction skeleton corresponds to an action, and will be built into a single transaction that is ready to be submitted to CKB. Surrounding the idea of TransactionSkeleton, a series of conveniences are provided to aid transaction assembling:</p><ul><li>A well designed component should automatically query and include cells to provide capacities required by the transaction.</li><li>Individual script logic should be managed and respected by the general transaction skeleton.</li><li>Scripts sharing the same behavior should be managed together in a unified interface. Developers can rely on abstractions instead of catering for every single detail.</li></ul><p>This still sounds quite complicated, let&#x27;s walkthrough an example to see how we can leverage TransactionSkeleton.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // In practice, you might already have the address at your hand, here we just</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // want to demonstrate how this works.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const script = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  code_hash: &quot;0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  hash_type: &quot;type&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  args: &quot;0xcbfbb9edb5838e2d61061c3fc69eaaa5fdbd3273&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const {generateAddress, parseAddress, createTransactionFromSkeleton,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sealTransaction, TransactionSkeleton } = require(&quot;@ckb-lumos/helpers&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const address = generateAddress(script);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // Now let&#x27;s create the actual skeleton, and deposit CKBytes into the skeleton</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; let skeleton = TransactionSkeleton({ cellProvider: indexer });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const { secp256k1Blake160, dao } = require(&quot;@ckb-lumos/common-scripts&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // Using utility provided in common-scripts, let&#x27;s deposit 1000 CKBytes into</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // the skeleton. We will introduce common-scripts separately below. Here we are</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // using the same address as from and to, but this does not have to be the case</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // everywhere.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; skeleton = await dao.deposit(skeleton, address, address, 100000000000n);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // createTransactionFromSkeleton is designed to build a final transaction, but</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // there is nothing stopping you from using it to peek into the current skeleton.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; console.log(JSON.stringify(createTransactionFromSkeleton(skeleton), null, 2));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // But this transaction is not yet complete, we still need 2 parts:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // * Transaction fee is not taken into consideration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // * The transaction is not signed yet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // Let&#x27;s take a look at them separately.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // First, since we are using the default secp256k1-blake160 lock script, an</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // existing module in common-scripts can be leveraged to incur transaction</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // fee. Here we are using the same address to provide 1 CKByte as transaction</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // fee.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; skeleton = await secp256k1Blake160.payFee(skeleton, address, 100000000n);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // If you checked the transaction skeleton after incurring fees. You will</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // notice that it only has one input. This might raise a question: if NervoDAO</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // deposit consumes one input cell, transaction fee requires a different input</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // cell, shouldn&#x27;t there be 2 input cells with 3 output cells(a deposited cell,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // and 2 change cell)? The trick here, is that common-scripts is smart enough</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // to figure out that the 2 actions here use the same address. Hence it just</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // rewrite the change cell generated in the NervosDAO deposit action to pay</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // enough transaction fee.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; createTransactionFromSkeleton(skeleton).inputs.length;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // Now the transaction is more or less complete, we can start generate messages</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // used for signing.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; skeleton = secp256k1Blake160.prepareSigningEntries(skeleton);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // This method actually loops through the skeleton, and create `signingEntries`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // that are using the default secp256k1-blake160 lock script:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; skeleton.get(&quot;signingEntries&quot;).toArray();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    type: &#x27;witness_args_lock&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    index: 0,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    message: &#x27;0x40811fd6ed74b9042f603dc7f2f577da7ebe0e05175d349dbb5c539b1111b83f&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Lumos, for now, does not handle message signing for the following reasons:</p><ul><li>This is a serious matter that relates to the overall security of the dapp, we want to make sure we are doing this properly if/when we decide to do it.</li><li>Different dapps might have different requirements, some don&#x27;t do signing at all, having signing built-in might render certain dapps hard to build.</li></ul><p>Using a secp256k1 tool, it&#x27;s not hard to generate a signature here based on the private key listed above, and the message. And we can continue with this process:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const signatures = [&quot;0x1cb952fd224d1d14d07af621587e91a65ccb051d55ed1371b3b66d4fe169cf7758173882e4c02587cb54054d2de287cbb1fdc2fc21d848d7b320ee8c5826479901&quot;];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const tx = sealTransaction(skeleton, signatures);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now we have a complete transaction assembled, and we can send it to CKB:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const { RPC } = require(&quot;ckb-js-toolkit&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const rpc = new RPC(&quot;http://127.0.0.1:8114&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; await rpc.send_transaction(tx);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&#x27;0x88536e8c25f5f8c89866dec6a5a1a6a72cccbe282963e4a7bfb5542b4c15d376&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now we have successfully deposited CKBytes into CKB using lumos!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="withdraw">Withdraw<a class="hash-link" href="#withdraw" title="Direct link to heading">​</a></h2><p>The following code can help us list all deposited Nervos DAO cells for an address:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; for await (const cell of dao.listDaoCells(indexer, address, &quot;deposit&quot;)) { console.log(cell); }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  cell_output: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    capacity: &#x27;0x174876e800&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    lock: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      code_hash: &#x27;0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      hash_type: &#x27;type&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      args: &#x27;0xcbfbb9edb5838e2d61061c3fc69eaaa5fdbd3273&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    type: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      code_hash: &#x27;0x82d76d1b75fe2fd9a27dfbaa65a039221a380d76c926f378d3f81cf3e7e13f2e&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      hash_type: &#x27;type&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      args: &#x27;0x&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  out_point: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    tx_hash: &#x27;0x88536e8c25f5f8c89866dec6a5a1a6a72cccbe282963e4a7bfb5542b4c15d376&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    index: &#x27;0x0&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  block_hash: &#x27;0xa1ec7dc291774bc0fc229efba4a162c099a8d88ffa7ae2fa410cc574e0701ced&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  block_number: &#x27;0x196&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  data: &#x27;0x0000000000000000&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here we can find the cell we just deposited to Nervos DAO. Let&#x27;s now try to withdraw it from Nervos DAO:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // First, we will need to locate the cell. In a real dapp this is most likely</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // coming from user selection.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const cell = (await dao.listDaoCells(indexer, address, &quot;deposit&quot;).next()).value;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // For a new action, let&#x27;s create a new transaction skeleton</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; skeleton = TransactionSkeleton({ cellProvider: indexer });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // This time, we invoke withdraw method to prepare a withdraw skeleton</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; skeleton = await dao.withdraw(skeleton, cell, address);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // Fees are also necessary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; skeleton = await secp256k1Blake160.payFee(skeleton, address, 100000000n);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // And let&#x27;s generate signing entries again.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; skeleton = secp256k1Blake160.prepareSigningEntries(skeleton);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; skeleton.get(&quot;signingEntries&quot;).toArray();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    type: &#x27;witness_args_lock&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    index: 0,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    message: &#x27;0x24370c5cedc03c34ae0a00a10d9e62324bce07e8d155c839ff10991d73684c34&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // After we signed the message, we can get the signature:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const signatures2 = [&quot;0x5aed4480c82844506fefc1d92dd18422a123b8e880018ea4cfa7f95891c4781e6578facedd765676831cf3cca04492ec3ec3885ac8d0b6d90cb6c1d6f99e6ffb01&quot;];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // Now we can seal and send the transaction</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const tx2 = sealTransaction(skeleton, signatures2);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; await rpc.send_transaction(tx2);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&#x27;0xe411eb6a3cf4f659461cc7a9df9ff95a72b9624bf850b9ccad0c4d7f2ab444f6&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>See that withdrawing transaction is not so hard!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="locktime-pool">Locktime Pool<a class="hash-link" href="#locktime-pool" title="Direct link to heading">​</a></h3><p>We could&#x27;ve just showed the <a href="https://github.com/nervosnetwork/lumos/blob/ac96a3220ab2a148425120eaac216abe246ee1da/packages/common-scripts/index.d.ts#L262" target="_blank" rel="noopener noreferrer">unlock</a> method in <code>dao</code> module, which let you complete the withdrawing from Nervos DAO. But here I want to talk about a different construct in lumos: locktime pool.</p><p>If you look closer, you would notice that the cell consumed in <a href="https://github.com/nervosnetwork/rfcs/blob/master/rfcs/0023-dao-deposit-withdraw/0023-dao-deposit-withdraw.md#withdraw-phase-2" target="_blank" rel="noopener noreferrer">withdraw phase 2</a>, is really nothing but a cell with a certain lock period. Likewise, there might be other scripts on CKB, when combined with certain cell, just provide lock periods. The multisig script included in genesis cell, is one such example. So the idea arises: what if we build a unified pool, that handles all cells that have lock periods? When designed properly, we can ignore the fact that they might come from different dapps, using different scripts. What we do care, is that each of those cells comes with a capacity and lock period, when the lock period is reached, they are nothing but ordinary cells in one&#x27;s wallet.</p><p>Given this thought, we designed <code>locktime pool</code> in lumos. Right now it only processes Nervos DAO cells in withdraw phase 2 and multisig cells, but in the future there is nothing stopping us from integrating more scripts that provide lock periods. From a developer point of view, locktime pool, can be used to manage all of them, provide a unified view in dapps.</p><p>As usual, we can query for all cells currently in the locktime pool:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const { locktimePool } = require(&quot;@ckb-lumos/common-scripts&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; for await (const cell of locktimePool.collectCells(indexer, address)) { console.log(cell); }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  cell_output: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    capacity: &#x27;0x174876e800&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    lock: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      code_hash: &#x27;0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      hash_type: &#x27;type&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      args: &#x27;0xcbfbb9edb5838e2d61061c3fc69eaaa5fdbd3273&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    type: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      code_hash: &#x27;0x82d76d1b75fe2fd9a27dfbaa65a039221a380d76c926f378d3f81cf3e7e13f2e&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      hash_type: &#x27;type&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      args: &#x27;0x&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  out_point: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    tx_hash: &#x27;0xe411eb6a3cf4f659461cc7a9df9ff95a72b9624bf850b9ccad0c4d7f2ab444f6&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    index: &#x27;0x0&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  block_hash: &#x27;0xb468ec0a1aed1f7070fc00952453ac882dbe36b1afbfb520c822fe46b3b81dfe&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  block_number: &#x27;0x543&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  data: &#x27;0x9601000000000000&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  maximumCapacity: 100153459536n,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  since: &#x27;0x20000a00060000dc&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  depositBlockHash: &#x27;0xa1ec7dc291774bc0fc229efba4a162c099a8d88ffa7ae2fa410cc574e0701ced&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  withdrawBlockHash: &#x27;0xb468ec0a1aed1f7070fc00952453ac882dbe36b1afbfb520c822fe46b3b81dfe&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sinceBaseValue: undefined</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here we can found the cell just created from NervosDAO withdrawing step. Let&#x27;s try to consume it using locktimePool:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; // Notice you will wait till the lock period of the cell has passed, otherwise this function would throw an error:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; skeleton = await locktimePool.transfer(skeleton, [address], address, 100153459536n, (await rpc.get_tip_header()));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; console.log(JSON.stringify(createTransactionFromSkeleton(skeleton), null, 2));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;version&quot;: &quot;0x0&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;cell_deps&quot;: [],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;header_deps&quot;: [],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;inputs&quot;: [],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs&quot;: [],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;outputs_data&quot;: [],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;witnesses&quot;: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This might actually be a surprise: we invoked transfer method, but it does nothing! Turns out the reason here, is that we are using the same address as both transfer input, and transfer output. Lumos is smart enough to figure out that when you are using the same input and output, we don&#x27;t need to perform the action so as to save certain transaction fee.</p><p>One different question you might ask, is that we use the same address in deposit and withdraw steps, why those previous attempts work? The reason for this, is that deposited cell, or created cell in withdraw step 1 has special purposes, they represent unique <strong>actions</strong> that we want to perform, hence they are <strong>freezed</strong> in the transaction skeleton, so later when we optimize the transaction to combine inputs/outputs, we won&#x27;t touch those specially created cells. On the other hand, in locktime pool design, we treat a cell with expired lock period the same as a normal cell, they really have nothing different, hence here, lumos will try to optimize the transaction, by removing the action transferring amount from an address to itself. In lumos&#x27; eye, this is a no-op.</p><p>Now let&#x27;s try the same step using a different target address:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; skeleton = await locktimePool.transfer(skeleton, [address], &quot;ckt1qyqx57xrsztnq7g5mlw6r998uyc2f5hm3vnsvgsaet&quot;, 100153459536n, (await rpc.get_tip_header()));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; skeleton = await secp256k1Blake160.payFee(skeleton, address, 100000000n);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; skeleton = secp256k1Blake160.prepareSigningEntries(skeleton);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; skeleton.get(&quot;signingEntries&quot;).toArray();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    type: &#x27;witness_args_lock&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    index: 0,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    message: &#x27;0xf01fb9988ba0265597760f50df92a56162d650b119cc95e8508079af584bdbc7&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can generate the signature as always:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const signatures3 = [&quot;0x6edde41592b41d445fabfd1b1d6854cf643bba724a338b5751827d991affa5a979d12339250bf5ade45f7f2742cba1e3de0791e37ef03914459bcdd099908ec601&quot;];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const tx3 = sealTransaction(skeleton, signatures3);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; await rpc.send_transaction(tx3);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&#x27;0xbaa7bdd71b7ec975f5a75c49d300857981f333c4346d6d6de1297d8d9d9ce0e0&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is really the core part of this post, if you are not understanding this part, we recommend you to read it again, and try it in CKB by yourself. What we are showing here, is that by designing a set of common APIs, we can build a general facility, that manages many different script instances, given the fact that they share the same behavior. And it is really not only the secp256k1-blake160 single signing script that shall be managed by a wallet. Any scripts that follow certain behavior, can be treated as a cell managed in a wallet.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="common-script">Common Script<a class="hash-link" href="#common-script" title="Direct link to heading">​</a></h2><p>As we show above, locktime pool is one step ahead of the journey at managing different cells/scripts with similar behaviors. But we are not stopping here, we can continue further down the path: it is mentioned above, that those cells with lock period already passed, can be thought as normal cells. Can we treat them as usual, without needing to deal with locktime pool?</p><p>We have build <code>common</code> module for this. Given a set of address/configurations(since for some P2SH script, address alone won&#x27;t be enough), it can manage all cells using those scripts, including cells with expired lock period. Right now this includes the following:</p><ul><li>secp256k1-blake160 single signing script</li><li>secp256k1-blake160 multiple signing script</li><li>NervosDAO script(only cells in withdraw phase 2 are managed)</li></ul><p>And the list doesn&#x27;t stop here, we are working to provide a common API specification, that once implemented, can enable <code>common</code> and <code>locktime pool</code> to support those additional scripts as well. We do hope those 2 modules can help enable a unified cell manager in lumos, in which <code>common</code> handles all consumable cells, while <code>locktime pool</code> gives insights into cells that are locked now but will be usable in the future.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="recap">Recap<a class="hash-link" href="#recap" title="Direct link to heading">​</a></h2><p>Lumos aims to take care of the full lifecycle of your CKB dapp. In this post, we are just taking a sneak peek at all the powers. We will continue to work on documents as well as sample projects to showcase all the powers enabled by lumos. We welcome all of you to try out lumos, and tell us what you think of it. So we can continue enhancing it, to make it the beloved framework for building CKB dapps.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/nervosnetwork/docs-new/tree/develop/website/docs/labs/lumos-nervosdao.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/labs/introduction"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Introduction</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/labs/sudtbycapsule"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Write an SUDT Script by Capsule</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#components" class="table-of-contents__link toc-highlight">Components</a></li><li><a href="#initial-ckb-setup" class="table-of-contents__link toc-highlight">Initial CKB Setup</a></li><li><a href="#node-skeleton" class="table-of-contents__link toc-highlight">Node Skeleton</a></li><li><a href="#config-manager-setup" class="table-of-contents__link toc-highlight">Config Manager Setup</a></li><li><a href="#booting-indexer" class="table-of-contents__link toc-highlight">Booting Indexer</a></li><li><a href="#deposit" class="table-of-contents__link toc-highlight">Deposit</a><ul><li><a href="#transaction-skeleton" class="table-of-contents__link toc-highlight">Transaction Skeleton</a></li></ul></li><li><a href="#withdraw" class="table-of-contents__link toc-highlight">Withdraw</a><ul><li><a href="#locktime-pool" class="table-of-contents__link toc-highlight">Locktime Pool</a></li></ul></li><li><a href="#common-script" class="table-of-contents__link toc-highlight">Common Script</a></li><li><a href="#recap" class="table-of-contents__link toc-highlight">Recap</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Foundation</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.nervos.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">About Us</a></li></ul></div><div class="col footer__col"><div class="footer__title">Developer</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/nervosnetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://github.com/nervosnetwork/rfcs/blob/master/rfcs/0002-ckb/0002-ckb.md" target="_blank" rel="noopener noreferrer" class="footer__link-item">Whitepaper</a></li><li class="footer__item"><a href="https://github.com/nervosnetwork/rfcs" target="_blank" rel="noopener noreferrer" class="footer__link-item">RFCs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/AqGTUE9" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://talk.nervos.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum</a></li><li class="footer__item"><a href="https://www.reddit.com/r/NervosNetwork/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reddit</a></li><li class="footer__item"><a href="https://t.me/nervosnetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/nervosnetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://medium.com/nervosnetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item">Medium</a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCONuJGdMzUY0Y6jrPBOzH7A" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021  Nervos Foundation. All Rights Reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b62abc76.js"></script>
<script src="/assets/js/main.8e1dff1b.js"></script>
</body>
</html>